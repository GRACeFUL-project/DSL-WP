\documentclass{article}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\usepackage[utf8]{inputenc}
\usepackage{color}
\usepackage[unicode=true]{hyperref}
\hypersetup{breaklinks=true,
            bookmarks=true,
            pdfauthor={Patrik Jansson et al.},
            pdftitle={GRACeFUL D4.4: Testing and verification framework},
            colorlinks=true,
            citecolor=blue,
            urlcolor=blue,
            linkcolor=magenta,
            pdfborder={0 0 0}}
\urlstyle{same}  % don't use monospace font for urls
\setlength{\parindent}{0pt}
\setlength{\parskip}{4pt plus 2pt minus 1pt}
\setlength{\emergencystretch}{3em}  % prevent overfull lines

%% Cezar
\usepackage[margin=1.60in]{geometry}
\usepackage[verbose]{wrapfig}
\usepackage{graphicx}
\usepackage{subfig}
\usepackage{rotating}
\usepackage{lscape}
\usepackage{float}
\usepackage{geometry}
\usepackage{framed}
\usepackage{xspace}
\usepackage{acronym}
\usepackage[square,numbers]{natbib}

%% Max
\usepackage{minted}
\usepackage{todonotes}

%% Alex
\newminted{haskell}{fontsize=\normalsize,xleftmargin=2mm,mathescape,linenos}
\newcommand{\haskell}[1]{\mintinline{haskell}|#1|}
\DefineShortVerb{\|}
\AtBeginEnvironment{minted}{%
  \renewcommand{\fcolorbox}[4][]{#4}}

\definecolor{GRACeFULblue}{rgb}{0.20,0.60,0.86}

\newcommand{\grace}{GRACeFUL\xspace}
\acrodef{GCM}{\grace Concept Map}
\acrodef{GMB}{Group Model Building}
\acrodef{DSL}{Domain Specific Language}
\acrodef{CFP}{Constraint Functional Program}
\acrodef{RAT}{Rapid Assessment Tool}
\acrodef{CRUD}{Climate Resilient Urban Design}
\acrodef{CLD}{Causal Loop Diagram}
\acrodef{JSON}{JavaScript Object Notation}
\acrodef{CP}{Constraint Program}
\hyphenation{GRACeFUL}

\author{}
\date{}

\begin{document}

\begin{center}
\includegraphics[width=5cm]{../coverpage/GRACeFULlogo.png}

\textcolor{GRACeFULblue}{Global systems Rapid Assessment tools\\
through Constraint FUnctional Languages}

\vspace{1cm}

FETPROACT-1-2014 Grant Nº 640954

\end{center}

\begin{framed}
\begin{center}
\Large
D4.4: Testing and verification framework\\[1ex]

\large
D4.4 Testing and verification framework for RATs\\
with applications to the CRUD case study\\[1ex]

\end{center}
\end{framed}

\vspace{1cm}

\noindent
\begin{tabular}{@{}ll@{}}
  Lead Participant:       & Chalmers (WP leader: P. Jansson)
\\Dissemination Level:    & PU
\\Document Version:       & Draft
\\Date of Submission:     & 201?-??-??
\\Due Date of Delivery:   & 2018-01-31
\end{tabular}

\newpage

\section*{D4.4 Testing and verification framework for RATs with
  applications to the CRUD case study}

Contributions by: Maximilian Algehed, Sólrún Einarsdóttir, Alex
Gerdes, and Patrik Jansson.

\begin{abstract}

This fourth deliverable (D4.4) of work package 4 presents a framework for
testing and verification of RATs.
%
The work leading up to this deliverable is within Task 4.5 ``Build a
testing and verification framework for RATs'' and the full source code
of the implementation is available on GitHub.


\end{abstract}

\vfill

\setcounter{tocdepth}{2}
\tableofcontents

\vfill


\newpage

\section{Introduction}

\input{intro}

\subsection{Property-based testing}
\todo{Alex: introduce property based testing: [before Jan]}
\input{intro-property-based-testing}

\section{}
\todo{Alex: type systems as another testing/verification technique we make use of. TypedValues}

\section{Testing Communicating Systems}
%
SessionCheck \cite{SessionCheck} is a tool developed in WP 4 to test distributed systems like
the GRACeFUL editor.
%
The tool is focused on the communication protocols used between the components.
%
In the case of the GRACeFUL editor the protocol would be the REST API descirbed in \cite{D4.3}. 
%
Typical testing of distrubted systems is done by maintaining a database consisting of hundreds
or thousands of test-cases each specifying the behaviour of one party in the protocol with
respect to a specific exchange of messages, a trace.
%
This approach is not ideal, as each test case is an artifact on its own which needs to be kept
in sync with the rest of the software.
%
SessionCheck releives developers of the duty of maintaining hundreds of software artifacts with
the duty of maintaining three, the client, the server, and the SessionCheck specification.

\begin{figure}
  \begin{minted}{haskell}
    echo = do
      s <- send anyString
      get (is s)
  \end{minted}
  \caption{\label{fig:SessionCheck:echo} The \texttt{echo} protocol}
\end{figure}

See Figure \ref{fig:SessionCheck:echo} for an example of a SessionCheck specfication.
%
The specification specifies the \texttt{echo} protocol, in this protocol the client sends
a single string to the server which replies with the same string.
%
We can use this specification to verify that either a client or a server implementation of
the protocol is correct.
%
For example, when testing a faulty server implementation SessionCheck will print the following:
\begin{verbatim}
TODO TODO TODO TODO
\end{verbatim}

\todo{Maximilian: Testing of communicating systems: keeping components and protocols in sync [draft before Jan]}

\todo{Solrun+Maximilian: Testing solvers and backends: challenges and partial solutions}
\input{solver-testing}


\section{Property based testing of GRACe programs}

Maximilian: Tell the story about bugs fixed in the compiler?

\todo{Solrun: try out sessioncheck before Jan.}

\todo{Max: fill in more based on using Jan.}

\section{Conclusion}

\end{document}

From Y2 review: ``We suggest that deliverables consisting of software
products also contain a written document that includes motivations,
use cases, explanations, user’s manuals, and informal semantics (if
possible).''

Note that D4.4 and D2.5 are both deliverables of type

  "DEM: Demonstrator, Pilot, Plans",

which is not described in detail in the H2020 documentation.
