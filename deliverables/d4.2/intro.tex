\section{Introduction}\label{introduction}

This document is the text part of the second deliverable (D4.2) of
work package 4 of the \grace project.
%
The software part is freely available in the project repository on
GitHub\footnote{\url{https://github.com/GRACeFUL-project/}}.

The main task of work package 4 is to build a \emph{\ac{DSL}} for
\acp{GCM}.
%
A \ac{GCM} is a representation of policy analysis that contains the
main elements of a policy problem definition, such as goals, criteria,
and a description of the system.
%
A \ac{GCM} is developed and manipulated by stakeholders during
\ac{GMB} sessions.
%
The information from and for the stakeholders will go through at least
two layers of the \grace system before it reaches the constraint
solver.
%
First, through the graphical visual interface, which will assist the
stakeholders in building the problem definition, and which will
present the results of the solver, and second, the \ac{DSL} that
will translate between the visual interface and the constraint
programming layer.

The \ac{DSL} can be regarded as an intermediate layer between the
visual representation of a \acf{GCM} and a corresponding constraint
program.
%
Translating the visual representation directly to a constraint program
would be difficult, and it would be hard to check if the generated
program was correct.
%
A DSL alleviates this problem and allows us to validate the
correctness of a model.
%
In addition, a \ac{DSL} improves the scalability by abstracting away
from the constraint solver.
%
In the longer term this will lead to a \ac{DSL} aimed at building
scalable \acp{RAT} for collective policy making in Global Systems.

% How have the definitions from D4.1 changed

In the previous deliverable~\cite{D4.1} we formalised the various
elements of \acp{GCM}, mainly focused on \acp{CLD}.
%
Progressive insight showed us that \acp{CLD} are not enough to model
the systems the project is envisioning, such as for the \ac{CRUD} case
study.
%
Instead of just using \aclp{CLD} we have extended our \ac{DSL} such
that we can model the system dynamics in a more general way, such as
using \emph{hybrid stock-and-flow-like} diagrams (which is
a generalisation of a \ac{CLD}~\cite{burns}).
%
Such diagrams allow for a more detailed (semi-)quantitative
analysis.

% We have constructed a DSL, link to github

We have implemented the \acl{DSL} in the functional programming
language Haskell~\cite{haskell98}.
%
Haskell is the so-called host language in which the \ac{DSL} is
embedded.
%
Language features such as algebraic datatypes, higher-order functions,
lazy evaluation, and a rich type system makes Haskell particularly
suitable for defining \acp{DSL}.
%
Our \ac{DSL} is briefly explained in Section~\ref{sec:gl} and the
full source code is freely available in the project repository on
GitHub.

% Explain the structure of the rest of the doc

We continue this document by giving the necessary background
information, in Section~\ref{sec:background}, for making the remaining
sections more accessible.
%
We present the details of the \ac{DSL} for \acp{GCM} including some
examples in Section~\ref{sec:gl}.
%
Section~\ref{install-and-reqs} provides installation- and usage
instructions for the \ac{DSL} implementation, as well as an overview
of the software dependencies.
%
Finally, we explore the formal semantics of the \ac{DSL} in
Section~\ref{sec:semantics}.
